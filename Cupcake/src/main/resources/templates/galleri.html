<!DOCTYPE html>
<html lang="da">
<head>

    <!-- Meta -->
    <meta charset="UTF-8"> <!-- ÆØÅ -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- In case some nerd uses Internet Explorer -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Mobile Responsiveness -->
    <meta name="description" content="Fuck vi hader livet jo... #swag"> <!-- SEO / Google -->
    <meta name="author" content="Gruppe D"> <!-- Author of Website -->

    <!-- Visuals -->
    <title>Olsker Cupcakes</title>

    <!-- Icon -->
    <link rel="icon" href="/images/icons/cupcake-1.png" type="image/x-icon"> <!-- That little logo thats next to the title in URL -->
    <link rel="apple-touch-icon" href="/images/icons/cupcake-1.png">

    <!-- CSS Load -->
    <link rel="stylesheet" href="/css/style.css">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Framwork load -->
    <link rel="stylesheet" href="/css/guacamoleboy-wow.css">
    <link rel="stylesheet" href="/css/guacamoleboy-framework.css">
    <script src="/js/guacamoleboy-wow.js" defer></script>

    <!-- Modules -->
    <script type="module" src="/js/components/navbar.js" defer></script>
    <script type="module" src="/js/components/footer.js" defer></script>
    <script type="module" src="/js/components/footer-nav.js" defer></script>
    
    <!-- Scripts -->
    <script src="/js/heart-button.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    <script src="/js/notification.js" defer></script>

</head>
<body class="subpage galleri-page">

    <!-- Navbar -->
    <div id="navbar-component"></div>
    <!-- Navbar -->

    <!-- Hero Section Start -->
    <section class="hero">

        <div class="guac-container">
            <div class="guac-row">

            </div>
        </div>

        <!-- End Wave Hero Start -->
        <div class="wave-1">
            <img src="/images/waves/wave-top.svg">
        </div>
        <!-- End Wave Hero End -->

    </section>
    <!-- Hero Section End -->

    <!-- Gallery Section Start -->
    <section class="section-1">
        <div class="guac-container">
            <div class="guac-row">

                <!-- Gallery col-12 Start -->
                <div class="guac-col-12 guac-mt-5">
                    <h2>Galleri</h2>
                    <p>Se, like og kommenter vores nyeste opslag!</p>
                    
                    <!-- Admin Create Post Button -->
                    <div th:if="${user != null and user.role == 'admin'}" class="admin-controls">
                        <button class="guac-btn guac-btn-primary" onclick="document.getElementById('create-post-modal').style.display='flex'">
                            <i class="fa-solid fa-plus"></i> Opret Nyt Opslag
                        </button>
                    </div>
                    
                    <!-- Grid Showcase Start -->
                    <div class="gallery-grid">
                        <div th:each="post : ${posts}" 
                             th:classappend="${post.sizeClass}" 
                             th:attr="data-post-id=${post.id}"
                             class="gallery-item">
                            <img th:src="${post.imageUrl}" alt="Galleri Billede" class="gallery-item__img">
                            <button class="heart-btn" 
                                    th:classappend="${userLikes.get(post.id) ? 'liked' : ''}"
                                    th:onclick="'toggleLike(' + ${post.id} + ', this)'">
                                <i th:class="${userLikes.get(post.id) ? 'fa-solid fa-heart' : 'fa-regular fa-heart'}"></i>
                            </button>
                            <div class="gallery-item__details">
                                <p th:text="${post.description}">Beskrivelse</p>
                                
                                <!-- Likes and Comments -->
                                <div class="gallery-item__lac">
                                    <span>
                                        <i class="fa-regular fa-heart"></i> 
                                        <span class="like-count" th:text="${likeCounts.get(post.id)}">0</span>
                                    </span>
                                    <span style="cursor: pointer;" th:onclick="'showComments(' + ${post.id} + ')'">
                                        <i class="fa-regular fa-comment"></i> 
                                        <span class="comment-count" th:text="${commentCounts.get(post.id)}">0</span>
                                    </span>
                                </div>
                                <!-- Likes and Comments -->

                                <!-- Admin Delete Button -->
                                <div th:if="${user != null and user.role == 'admin'}" class="admin-delete">
                                    <form method="post" action="/gallery/post/delete" style="display: inline;">
                                        <input type="hidden" name="postId" th:value="${post.id}">
                                        <button type="submit" class="delete-btn" onclick="return confirm('Er du sikker på du vil slette dette opslag?')">
                                            <i class="fa-solid fa-trash"></i>
                                        </button>
                                    </form>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- Grid Showcase End -->

                </div>
                <!-- Gallery col-12 End -->

            </div>
        </div>

        <!-- End Wave Section 2 Start -->
        <div class="wave-3">
            <img src="/images/waves/footer-wave.svg">
        </div>
        <!-- End Wave Section 2 End -->

    </section>
    <!-- Gallery Section End -->

    <!-- Footer -->
    <div id="footer-component"></div>
    <!-- Footer -->

    <!-- Footer Nav -->
    <div id="footer-nav-component"></div>
    <!-- Footer Nav -->

    <!-- Create Post Modal (Admin Only) -->
    <div id="create-post-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="document.getElementById('create-post-modal').style.display='none'">&times;</span>
            <h2>Opret Nyt Galleri Opslag</h2>
            <form method="post" action="/gallery/post">
                <div class="form-group">
                    <label for="imageUrl">Billede URL:</label>
                    <input type="text" id="imageUrl" name="imageUrl" placeholder="/images/gallery/cupcake.png" required>
                </div>
                <div class="form-group">
                    <label for="description">Beskrivelse:</label>
                    <textarea id="description" name="description" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="sizeClass">Størrelse (valgfrit):</label>
                    <select id="sizeClass" name="sizeClass">
                        <option value="">Normal</option>
                        <option value="gallery-item--extreme">Ekstra Stor</option>
                        <option value="gallery-item--large">Stor</option>
                        <option value="gallery-item--medium">Medium</option>
                        <option value="gallery-item--half">Halv</option>
                    </select>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="guac-btn guac-btn-secondary" onclick="document.getElementById('create-post-modal').style.display='none'">
                        Annuller
                    </button>
                    <button type="submit" class="guac-btn guac-btn-primary">
                        Opret Opslag
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Comments Modal -->
    <div id="comments-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeCommentsModal()">&times;</span>
            <h2>Kommentarer</h2>
            <div id="comments-list" class="comments-list">
                <!-- Comments will be loaded here dynamically -->
            </div>
            <div class="comment-form" id="comment-form">
                <textarea id="comment-input" placeholder="Skriv en kommentar..." rows="3"></textarea>
                <button class="guac-btn guac-btn-primary" onclick="submitComment()">
                    <i class="fa-solid fa-paper-plane"></i> Send
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="guac-notification-container"></div>
    <!-- Notification -->

</body>
</html>