Table users {
  id serial [pk]
  email varchar(255) [unique, not null]
  password_hash text [not null]
  role varchar(20) [default: 'customer', not null]
  username varchar(100) [unique, not null]
  phone varchar(20) [unique]
  payment_attached boolean [default: false]
  created_at timestamp [default: `now()`]
}

Table payment_info {
  id serial [pk]
  user_id int [ref: > users.id]
  card_number varchar(19) [not null]
  cardholder_name varchar(255) [not null]
  expiry_month int [not null]
  expiry_year int [not null]
  cvv_hash text [not null]
  created_at timestamp [default: `now()`]
}

Table cupcake_flavor {
  id serial [pk]
  name varchar(100) [not null]
  price decimal(10,2) [not null]
}

Table cupcake_toppings {
  id serial [pk]
  name varchar(100) [not null]
  price decimal(10,2) [not null]
}

Table categories {
  id serial [pk]
  name varchar(100) [unique, not null]
}

Table products {
  id serial [pk]
  name varchar(150) [not null]
  description text
  price decimal(10,2) [not null]
  image_url text
  category_id int [ref: > categories.id]
  topping_id int [ref: > cupcake_toppings.id]
  flavor_id int [ref: > cupcake_flavor.id]
  created_at timestamp [default: `now()`]
}

Table orders {
  id serial [pk]
  user_id int [ref: > users.id]
  status varchar(20) [default: 'open', not null]
  created_at timestamp [default: `now()`]
}

Table order_items {
  id serial [pk]
  order_id int [ref: > orders.id]
  product_id int [ref: > products.id]
  bottom_id int [ref: > cupcake_flavor.id]
  topping_id int [ref: > cupcake_toppings.id]
  quantity int [default: 1, not null]
}

Table transactions {
  id serial [pk]
  user_id int [ref: > users.id]
  amount decimal(10,2) [not null]
  created_at timestamp [default: `now()`]
  description text
}