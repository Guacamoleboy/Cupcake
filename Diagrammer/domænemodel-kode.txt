@startuml

class User {
    - int id
    - String email
    - String passwordHash
    - String role
    - String username
    - String phone
    - boolean paymentAttached
    - double balance
    - Timestamp createdAt
}

class PaymentInfo {
    - int id
    - String cardNumber
    - String cardholderName
    - int expiryMonth
    - int expiryYear
    - String cvvHash
    - Timestamp createdAt
}

class CupcakeFlavor {
    - int id
    - String name
    - double price
}

class CupcakeTopping {
    - int id
    - String name
    - double price
}

class Category {
    - int id
    - String name
}

class Product {
    - int id
    - String name
    - String description
    - double price
    - String imageUrl
    - Timestamp createdAt
}

class DeliveryMethod {
    - int id
    - String name
    - double price
}

class PaymentMethod {
    - int id
    - String name
}

class Order {
    - int id
    - String status
    - String deliveryAddress
    - Timestamp createdAt
}

class OrderItem {
    - int id
    - int quantity
}

class Transaction {
    - int id
    - double amount
    - String description
    - Timestamp createdAt
}

class Coupon {
    - int id
    - String code
    - int discountPercent
    - Timestamp validFrom
    - Timestamp validUntil
}

class Refund {
    - int id
    - String reason
    - Timestamp createdAt
    - String status
}


User "1" -- "0..*" PaymentInfo : has
User "1" -- "0..*" Order : places
User "1" -- "0..*" Transaction : owns
User "1" -- "0..*" Refund : requests

Order "1" -- "1..*" OrderItem : contains
Order "0..1" -- "0..*" DeliveryMethod : uses
Order "0..1" -- "0..*" PaymentMethod : paysWith
Order "0..1" -- "0..*" Coupon : applies
Order "1" -- "0..*" Refund : generates

OrderItem "1" -- "1" Product : refersTo
Product "0..1" -- "0..*" Category : belongsTo
Product "0..1" -- "0..*" CupcakeFlavor : hasFlavor
Product "0..1" -- "0..*" CupcakeTopping : hasTopping

OrderItem "0..1" -- "0..*" CupcakeFlavor : selectedFlavor
OrderItem "0..1" -- "0..*" CupcakeTopping : selectedTopping

@enduml